<!DOCTYPE html><!--QZ047DAR5p9TkcGxb0HUL--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/345c85a432359eed-s.p.eead68dd.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/ce62453a442c7f35-s.p.a9507876.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/chunks/6cef0e87a1eeed56.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/71bdf22b73743287.js"/><script src="/_next/static/chunks/9647195743d9cd8e.js" async=""></script><script src="/_next/static/chunks/2bcc103025a24bbf.js" async=""></script><script src="/_next/static/chunks/6fe6373db140f402.js" async=""></script><script src="/_next/static/chunks/turbopack-02f24882a303450e.js" async=""></script><script src="/_next/static/chunks/336a942e6ebf3183.js" async=""></script><script src="/_next/static/chunks/d568515730fc15cf.js" async=""></script><script src="/_next/static/chunks/9a745956972e37d4.js" async=""></script><script src="/_next/static/chunks/fa8b3f33c90f0e69.js" async=""></script><meta name="next-size-adjust" content=""/><title>Why You Should Always Use Promise.all() for Array of Promises</title><meta name="description" content="Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance."/><meta name="keywords" content="JavaScript,Promise.all,asynchronous programming,error handling,nodejs,best practices"/><link rel="canonical" href="https://alexprisacariu.dev/posts/post011_always_use_promise_all"/><meta property="og:title" content="Why You Should Always Use Promise.all() for Array of Promises"/><meta property="og:description" content="Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance."/><meta property="og:url" content="https://alexprisacariu.dev/posts/post011_always_use_promise_all"/><meta property="og:image" content="https://alexprisacariu.dev/imgs/posts/no-cover.png"/><meta property="og:image" content="https://alexprisacariu.dev/imgs/posts/no-thumbnail.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Why You Should Always Use Promise.all() for Array of Promises"/><meta name="twitter:description" content="Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance."/><meta name="twitter:image" content="https://alexprisacariu.dev/imgs/posts/no-cover.png"/><meta name="twitter:image" content="https://alexprisacariu.dev/imgs/posts/no-thumbnail.png"/><script id="load-theme">
                (function() {
                                function getInitialTheme() {
                                  const stored = localStorage.getItem("theme-color-scheme");
                                  if (stored) {
                                    return stored;
                                  }
                                  const userMedia = window.matchMedia('(prefers-color-scheme: dark)');
                                  if (userMedia.matches) {
                                    return 'dark';
                                  }
                                  return 'light';
                                }
                                const theme = getInitialTheme();
                                if (theme === 'dark') {
                                  document.documentElement.classList.add('dark');
                                } else {
                                  document.documentElement.classList.remove('dark');
                                }
                              })();
            </script><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="lato_d53d54d3-module__fBU7ea__variable roboto_90ab2718-module__mv-f4W__variable antialiased"><div hidden=""><!--$--><!--/$--></div><div class="fixed h-1 shadow-lg shadow-sky-500/20 inset-0 z-9999" style="background-color:oklch(40.8% 0.153 2.432);width:0%"></div><header class="print:hidden sticky top-0 flex h-16 items-center gap-4 bg-background z-50 box"><nav class="flex flex-row items-center justify-between w-full h-full md:border-b"><a class="font-accent font-bold text-lg no-link" href="/"><div class="md:hidden">AP</div><div class="hidden md:block xl:hidden">Alex Prisacariu</div><div class="hidden xl:block">Alexandru Prisacariu</div></a><div class="nav-links hidden flex-col gap-6 text-lg font-medium md:flex md:flex-row md:items-center md:justify-between md:gap-5 md:text-sm lg:gap-6"><a class="" href="/">Home</a><a class="" href="/projects">Projects</a><a class="" href="/blog/1">Blog</a><a class="" href="/about">About</a><a class="" href="/cv">Resume/CV</a><a class="" href="mailto:alex@alexprisacariu.dev">Contact</a><button class="hover:bg-card-hover hover:cursor-pointer p-2 rounded"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-5 h-5" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M8 12a4 4 0 1 0 8 0 4 4 0 1 0-8 0M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"></path></svg></button></div><div class="md:hidden"><button class="hover:bg-card-hover hover:cursor-pointer p-2 rounded"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-5 h-5" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M8 12a4 4 0 1 0 8 0 4 4 0 1 0-8 0M3 12h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"></path></svg></button><button class="hover:bg-card-hover hover:cursor-pointer p-2 rounded"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-5 h-5" viewBox="0 0 24 24"><path stroke="none" d="M0 0h24v24H0z"></path><path d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div></nav></header><div id="PostPage"><div class="box py-12"><div class="flex flex-col"><h1 class="text-3xl font-accent mb-2">Always use Promise.all() (or any other Promise&#x27;s method) for array of promises</h1><div class="post-tags mb-6"><span class="tag">September 16, 2023 at 07:01 PM</span><span class="tag">JavaScript/JS</span></div><div class="post-content"><p>At my job one of our services was crashing from time to time, but quite rarely.
Because it crashed only at a large interval of a few days it was not given that
much attention to it. The pod would crash and another pod would immediately be
created and ready to serve the requests.</p>
<p>But one day our internal DNS failed and all the pods of the service crashed.
After investigation we have seen that the DNS failed, but the service should
have not crashed, but in return it should serve a 500 to the clients.</p>
<p>After analyzing the service&#x27;s code I found this: our service was calling other
services to retrieve the required data. All of the requests to the other
services were handled inside a try/catch block, but something else was going
bad. Very bad. Very bad because the thrown exception was that the service&#x27;s
code was not handling a promise inside a try/catch block. But how?</p>
<p>Let see the next code:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-line-numbers="" data-language="js" data-theme="github-light github-dark" style="display:grid" data-line-numbers-max-digits="2"><span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> streams</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    firstStepStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        res.streams </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> [];</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    intermediateStep1Stream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        res.streams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> doRequestToSomeService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(req);</span></span>
<span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">            // Do things</span></span>
<span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">            // ...</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        })());</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    intermediateStep2Stream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        res.streams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> response2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> doRequestToSomeService2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(req);</span></span>
<span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">            // Do things</span></span>
<span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">            // ...</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        })());</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    },</span></span>
<span data-line=""><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    finalStepStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> res.streams) {</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> stream;</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (error) {</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">                res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span data-line=""><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">                return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            }</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        // ...</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span data-line=""><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">};</span></span></code></pre></figure>
<p>What is wrong here? Well, without much knowledge of JavaScript everything looks
fine. But then why the code fails in some situations?</p>
<p>If only one promise from <code>res.streams</code> fails then our code handles it very well
and will respond to the client with the 500 status code.</p>
<p>But if both promises fail then our code will crash.</p>
<p>Why? Because we are not handling the second failed promise. When the first
promise gets rejected it triggers the <code>catch</code> block and in our <code>catch</code> block of
code we have a <code>return</code> that will break the loop and our second promise will
not have the chance to be checked thus crashing the service with the proper
error (that we are not handling a promise).</p>
<p>Yes, we can do it correctly using the for loop (or any loop) as long as we
check every single promise we have. But why? We already have special methods
inside the <code>Promise</code> object for handling all the cases we would want:</p>
<ul>
<li><code>Promise.all()</code> for when we want for all the promises to succeed;</li>
<li><code>Promise.allSettled()</code> for when we just want for all the promises to be done; will never reject;</li>
<li><code>Promise.any()</code> for when we want at least one promise to succeed; first one to succeed will be returned; if all fail then the method fails;</li>
<li><code>Promise.race()</code> for when we want the fastest promise to succeed.</li>
</ul>
<p>And using the methods inside the <code>Promise</code> object allow us the benefit of
better internal engine optimizations.</p>
<p>Read more about the Promise object here:
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener noreferrer" target="_blank">MDN Web Docs: Promise</a></p></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div></div></div><!--$--><!--/$--><div class="box print:hidden"><div class="border-t py-3"><div>© <!-- -->2025<!-- --> Alexandru Prisacariu</div></div></div><div></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-XXXXXXXXXX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script src="/_next/static/chunks/71bdf22b73743287.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n3:I[27365,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n4:I[1198,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n5:I[93175,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n6:I[95777,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n7:I[14432,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n8:I[79962,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n9:I[14059,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n11:I[28398,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n:HL[\"/_next/static/chunks/6cef0e87a1eeed56.css\",\"style\"]\n:HL[\"/_next/static/media/345c85a432359eed-s.p.eead68dd.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/ce62453a442c7f35-s.p.a9507876.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:T428,"])</script><script>self.__next_f.push([1,"\n                (function() {\n                                function getInitialTheme() {\n                                  const stored = localStorage.getItem(\"theme-color-scheme\");\n                                  if (stored) {\n                                    return stored;\n                                  }\n                                  const userMedia = window.matchMedia('(prefers-color-scheme: dark)');\n                                  if (userMedia.matches) {\n                                    return 'dark';\n                                  }\n                                  return 'light';\n                                }\n                                const theme = getInitialTheme();\n                                if (theme === 'dark') {\n                                  document.documentElement.classList.add('dark');\n                                } else {\n                                  document.documentElement.classList.remove('dark');\n                                }\n                              })();\n            "])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"QZ047DAR5p9TkcGxb0HUL\",\"p\":\"\",\"c\":[\"\",\"posts\",\"post011_always_use_promise_all\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"post011_always_use_promise_all\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/6cef0e87a1eeed56.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/336a942e6ebf3183.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/_next/static/chunks/d568515730fc15cf.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"/_next/static/chunks/9a745956972e37d4.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"id\":\"load-theme\",\"children\":\"$2\"}]}],[\"$\",\"body\",null,{\"className\":\"lato_d53d54d3-module__fBU7ea__variable roboto_90ab2718-module__mv-f4W__variable antialiased\",\"children\":[\"$\",\"$L3\",null,{\"className\":\"fixed h-1 shadow-lg shadow-sky-500/20 inset-0 z-9999\",\"children\":[\"$\",\"$L4\",null,{\"children\":[[\"$\",\"header\",null,{\"className\":\"print:hidden sticky top-0 flex h-16 items-center gap-4 bg-background z-50 box\",\"children\":[\"$\",\"nav\",null,{\"className\":\"flex flex-row items-center justify-between w-full h-full md:border-b\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"font-accent font-bold text-lg no-link\",\"children\":[[\"$\",\"div\",null,{\"className\":\"md:hidden\",\"children\":\"AP\"}],[\"$\",\"div\",null,{\"className\":\"hidden md:block xl:hidden\",\"children\":\"Alex Prisacariu\"}],[\"$\",\"div\",null,{\"className\":\"hidden xl:block\",\"children\":\"Alexandru Prisacariu\"}]]}],[\"$\",\"$L6\",null,{}],[\"$\",\"$L7\",null,{}]]}]}],[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],\"$La\",\"$Lb\",\"$Lc\"]}]}]}]]}]]}],{\"children\":[\"posts\",\"$Ld\",{\"children\":[[\"id\",\"post011_always_use_promise_all\",\"d\"],\"$Le\",{\"children\":[\"__PAGE__\",\"$Lf\",{},null,false]},null,false]},null,false]},null,false],\"$L10\",false]],\"m\":\"$undefined\",\"G\":[\"$11\",[\"$L12\"]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"13:I[78796,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n14:I[94651,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"default\"]\n16:I[89610,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"OutletBoundary\"]\n18:I[92521,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"AsyncMetadataOutlet\"]\n1a:I[89610,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"ViewportBoundary\"]\n1c:I[89610,[\"/_next/static/chunks/336a942e6ebf3183.js\",\"/_next/static/chunks/d568515730fc15cf.js\",\"/_next/static/chunks/9a745956972e37d4.js\"],\"MetadataBoundary\"]\n1d:\"$Sreact.suspense\"\na:[\"$\",\"div\",null,{\"className\":\"box print:hidden\",\"children\":[\"$\",\"div\",null,{\"className\":\"border-t py-3\",\"children\":[\"$\",\"div\",null,{\"children\":[\"© \",2025,\" Alexandru Prisacariu\"]}]}]}]\nb:[\"$\",\"$L13\",null,{}]\nc:[\"$\",\"$L14\",null,{}]\nd:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\ne:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nf:[\"$\",\"$1\",\"c\",{\"children\":[\"$L15\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/fa8b3f33c90f0e69.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L16\",null,{\"child"])</script><script>self.__next_f.push([1,"ren\":[\"$L17\",[\"$\",\"$L18\",null,{\"promise\":\"$@19\"}]]}]]}]\n10:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L1a\",null,{\"children\":\"$L1b\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L1c\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$1d\",null,{\"fallback\":null,\"children\":\"$L1e\"}]}]}]]}]\n12:[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/6cef0e87a1eeed56.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]\n"])</script><script>self.__next_f.push([1,"1b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n17:null\n"])</script><script>self.__next_f.push([1,"15:[\"$\",\"div\",null,{\"id\":\"PostPage\",\"children\":[\"$\",\"div\",null,{\"className\":\"box py-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col\",\"children\":[false,[\"$\",\"h1\",null,{\"className\":\"text-3xl font-accent mb-2\",\"children\":\"Always use Promise.all() (or any other Promise's method) for array of promises\"}],[\"$\",\"div\",null,{\"className\":\"post-tags mb-6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"tag\",\"children\":\"September 16, 2023 at 07:01 PM\"}],[[\"$\",\"span\",\"JavaScript/JS\",{\"className\":\"tag\",\"children\":\"JavaScript/JS\"}]]]}],[\"$\",\"div\",null,{\"className\":\"post-content\",\"children\":\"$L1f\"}],[\"$\",\"div\",null,{\"className\":\"grid grid-cols-1 md:grid-cols-2 gap-4\",\"children\":\"$undefined\"}],\"$undefined\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"19:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Why You Should Always Use Promise.all() for Array of Promises\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"keywords\",\"content\":\"JavaScript,Promise.all,asynchronous programming,error handling,nodejs,best practices\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://alexprisacariu.dev/posts/post011_always_use_promise_all\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Why You Should Always Use Promise.all() for Array of Promises\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance.\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://alexprisacariu.dev/posts/post011_always_use_promise_all\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://alexprisacariu.dev/imgs/posts/no-cover.png\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image\",\"content\":\"https://alexprisacariu.dev/imgs/posts/no-thumbnail.png\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"Why You Should Always Use Promise.all() for Array of Promises\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"Understand why using Promise.all(), Promise.allSettled(), or Promise.any() is crucial for handling arrays of promises in JavaScript to prevent crashes and improve performance.\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://alexprisacariu.dev/imgs/posts/no-cover.png\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:image\",\"content\":\"https://alexprisacariu.dev/imgs/posts/no-thumbnail.png\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"1e:\"$19:metadata\"\n"])</script><script>self.__next_f.push([1,"1f:[[\"$\",\"p\",null,{\"children\":\"At my job one of our services was crashing from time to time, but quite rarely.\\nBecause it crashed only at a large interval of a few days it was not given that\\nmuch attention to it. The pod would crash and another pod would immediately be\\ncreated and ready to serve the requests.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"But one day our internal DNS failed and all the pods of the service crashed.\\nAfter investigation we have seen that the DNS failed, but the service should\\nhave not crashed, but in return it should serve a 500 to the clients.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"After analyzing the service's code I found this: our service was calling other\\nservices to retrieve the required data. All of the requests to the other\\nservices were handled inside a try/catch block, but something else was going\\nbad. Very bad. Very bad because the thrown exception was that the service's\\ncode was not handling a promise inside a try/catch block. But how?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let see the next code:\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"--shiki-light\":\"#24292e\",\"--shiki-dark\":\"#e1e4e8\",\"--shiki-light-bg\":\"#fff\",\"--shiki-dark-bg\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"js\",\"data-theme\":\"github-light github-dark\",\"children\":[\"$\",\"code\",null,{\"data-line-numbers\":\"\",\"data-language\":\"js\",\"data-theme\":\"github-light github-dark\",\"style\":{\"display\":\"grid\"},\"data-line-numbers-max-digits\":\"2\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" streams\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    firstStepStream\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"res\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        res.streams \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" [];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    },\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    intermediateStep1Stream\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"res\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        res.streams.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"push\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"((\"}],\"$L20\",\"$L21\",\"$L22\",\"$L23\"]}],\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\"]}]}]}],\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\",\"\\n\",\"$L45\"]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"async\"}]\n21:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" () \"}]\n22:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}]\n23:[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]\n"])</script><script>self.__next_f.push([1,"24:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            const\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" doRequestToSomeService\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(req);\"}]]}]\n"])</script><script>self.__next_f.push([1,"25:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"            // Do things\"}]}]\n26:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"            // ...\"}]}]\n27:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        })());\"}]}]\n28:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    },\"}]}]\n"])</script><script>self.__next_f.push([1,"29:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    intermediateStep2Stream\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"res\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}]\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        res.streams.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"push\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" () \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}]\n"])</script><script>self.__next_f.push([1,"2b:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            const\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" response2\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\" doRequestToSomeService2\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(req);\"}]]}]\n"])</script><script>self.__next_f.push([1,"2c:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"            // Do things\"}]}]\n2d:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"            // ...\"}]}]\n2e:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        })());\"}]}]\n2f:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    },\"}]}]\n"])</script><script>self.__next_f.push([1,"30:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"    finalStepStream\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\", \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#E36209\",\"--shiki-dark\":\"#FFAB70\"},\"children\":\"res\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}]\n"])</script><script>self.__next_f.push([1,"31:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"        for\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\" stream\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\" in\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" res.streams) {\"}]]}]\n32:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"            try\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" {\"}]]}]\n33:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                await\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" stream;\"}]]}]\n34:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            } \"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"catch\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\" (error) {\"}]]}]\n35:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                res.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#005CC5\",\"--shiki-dark\":\"#79B8FF\"},\"children\":\"500\"}],[\"$\",\"span\",null,{\"style\":{\"--shi"])</script><script>self.__next_f.push([1,"ki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\");\"}]]}]\n36:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"                res.\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6F42C1\",\"--shiki-dark\":\"#B392F0\"},\"children\":\"end\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"();\"}]]}]\n37:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#D73A49\",\"--shiki-dark\":\"#F97583\"},\"children\":\"                return\"}],[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\";\"}]]}]\n38:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"            }\"}]}]\n39:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"        }\"}]}]\n3a:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}]\n3b:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#6A737D\",\"--shiki-dark\":\"#6A737D\"},\"children\":\"        // ...\"}]}]\n3c:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"    }\"}]}]\n3d:[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"--shiki-light\":\"#24292E\",\"--shiki-dark\":\"#E1E4E8\"},\"children\":\"};\"}]}]\n3e:[\"$\",\"p\",null,{\"children\":\"What is wrong here? Well, without much knowledge of JavaScript everything looks\\nfine. But then why the code fails in some situations?\"}]\n3f:[\"$\",\"p\",null,{\"children\":[\"If only one promise from \",[\"$\",\"code\",null,{\"children\":\"res.streams\"}],\" fails then our code handles it very well\\nand will respond to the client with the 500 status code.\"]}]\n40:[\"$\",\"p\",null,{\"children\":\"But if both promises fail then our code will crash.\"}]\n41:[\"$\",\"p\",null,{\"children\":[\"Why? Because we are not handling the second fai"])</script><script>self.__next_f.push([1,"led promise. When the first\\npromise gets rejected it triggers the \",[\"$\",\"code\",null,{\"children\":\"catch\"}],\" block and in our \",[\"$\",\"code\",null,{\"children\":\"catch\"}],\" block of\\ncode we have a \",[\"$\",\"code\",null,{\"children\":\"return\"}],\" that will break the loop and our second promise will\\nnot have the chance to be checked thus crashing the service with the proper\\nerror (that we are not handling a promise).\"]}]\n42:[\"$\",\"p\",null,{\"children\":[\"Yes, we can do it correctly using the for loop (or any loop) as long as we\\ncheck every single promise we have. But why? We already have special methods\\ninside the \",[\"$\",\"code\",null,{\"children\":\"Promise\"}],\" object for handling all the cases we would want:\"]}]\n"])</script><script>self.__next_f.push([1,"43:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Promise.all()\"}],\" for when we want for all the promises to succeed;\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Promise.allSettled()\"}],\" for when we just want for all the promises to be done; will never reject;\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Promise.any()\"}],\" for when we want at least one promise to succeed; first one to succeed will be returned; if all fail then the method fails;\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"Promise.race()\"}],\" for when we want the fastest promise to succeed.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"44:[\"$\",\"p\",null,{\"children\":[\"And using the methods inside the \",[\"$\",\"code\",null,{\"children\":\"Promise\"}],\" object allow us the benefit of\\nbetter internal engine optimizations.\"]}]\n45:[\"$\",\"p\",null,{\"children\":[\"Read more about the Promise object here:\\n\",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":\"MDN Web Docs: Promise\"}]]}]\n"])</script></body></html>