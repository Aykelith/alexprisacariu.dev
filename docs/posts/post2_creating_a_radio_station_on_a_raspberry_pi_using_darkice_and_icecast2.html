<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui"/><title>Creating a radio station on a Raspberry Pi using DarkIce and IceCast2</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/be6eb7036e711b77.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be6eb7036e711b77.css" data-n-g=""/><link rel="preload" href="/_next/static/css/01837e1e5e74eb17.css" as="style"/><link rel="stylesheet" href="/_next/static/css/01837e1e5e74eb17.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-f65e66e62fc5ca80.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4462d17e3bd159c1.js" defer=""></script><script src="/_next/static/chunks/966-c86f4f98642ab2f5.js" defer=""></script><script src="/_next/static/chunks/987-d95b3bee188dc1e2.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5BdirName%5D-437b2e5da1949dca.js" defer=""></script><script src="/_next/static/q6iS-DDoknARBkdbxoWaq/_buildManifest.js" defer=""></script><script src="/_next/static/q6iS-DDoknARBkdbxoWaq/_ssgManifest.js" defer=""></script><script src="/_next/static/q6iS-DDoknARBkdbxoWaq/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div id="PostPage" class="page"><div class="box"><main class="flex flex-col"><a class="text-indigo-700 undefined" href="/posts/post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2#">&lt; See more posts</a><h1 class="text-4xl mt-1 mb-2">Creating a radio station on a Raspberry Pi using DarkIce and IceCast2</h1><div class="flex items-center mb-8 space-x-3"><div>12 March</div><div class="flex gap-1"><a class="hover:no-underline cursor-pointer" href="/posts/post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2#"><div class="text-sm px-1 text-white bg-blue-500 hover:bg-blue-400">#Linux</div></a><a class="hover:no-underline cursor-pointer" href="/posts/post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2#"><div class="text-sm px-1 text-white bg-blue-500 hover:bg-blue-400">#Raspberry Pi</div></a><a class="hover:no-underline cursor-pointer" href="/posts/post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2#"><div class="text-sm px-1 text-white bg-blue-500 hover:bg-blue-400">#Ubuntu</div></a><a class="hover:no-underline cursor-pointer" href="/posts/post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2#"><div class="text-sm px-1 text-white bg-blue-500 hover:bg-blue-400">#Audio</div></a></div></div><div class="postContent"><p>At my church we offer translations to people who cannot speak romanian, but the
system we are using is pretty low quality and is a lot of static noise and is
too expensive to upgrade it.</p><p>So I&#x27;ve thinked I would be able to use a Raspberry Pi 3, an audio interface and
some software to create a radio station that would then be hooked to the actual
system.</p><p>After searching for some software that would work on Raspberry Pi 3 I
discovered <code>IceCast2</code> that would be able to create a radio station and using
<code>DarkIce</code> to send the live audio from the microphone to <code>IceCast2</code>.</p><p>So I&#x27;ve booted <code>Ubuntu 20.04</code> for Raspberry Pi and installed <code>icecast2</code> from the
package manager.
For the <code>darkice</code> the version from the package manager was <strong>1.13</strong>, but the
latest available is <strong>1.14</strong> so I needed to compile it.  After some tries and
searching and found that needed to install <code>ALSA</code> and compile another library,
<code>lame</code>, because could not figure out how to configure <code>darkice</code> to use the
developer package from the package manager I figure it out and built the latest
version of <code>darkice</code>.</p><p>After playing out with both the <code>darkice</code> configuration and the <code>icecast2</code>
configuration I had a working radio station.
The only problem that I couldn&#x27;t anticipated was that the latency was just too
high for what I needed. I had around <strong>5 to 10 seconds</strong> of latency, which would
be quite perfect for a normal radio station, but not what I needed.</p><p>So here are the complet steps that I followed:</p><div class="remark-highlight"><pre class="language-bash  line-numbers"><code class="language-bash"><span class="token comment"># Installing icecast2</span>
<span class="token comment"># Installing ALSA utilities</span>
<span class="token comment"># Installing pkgconfig required for `darkice` configuration</span>
<span class="token comment"># Installing build-essentials for compiling `darkice` and `lame`</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y icecast2 alsa-utils asound2 libasound2-dev pkgconfig build-essentials

<span class="token comment"># Getting lame</span>
<span class="token function">wget</span> https://sourceforge.net/projects/lame/files/lame/3.100/lame-3.100.tar.gz
<span class="token function">tar</span> -xvf lame-3.100.tar.gz
<span class="token builtin class-name">cd</span> lame-3.100

<span class="token comment"># Configuring lame and building it</span>
./configure --with-fileio<span class="token operator">=</span>lame --disable-gtktest --enable-expopt<span class="token operator">=</span>full --prefix<span class="token operator">=</span>/usr
<span class="token function">make</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>

<span class="token comment"># Getting darkice</span>
<span class="token function">wget</span> https://github.com/rafael2k/darkice/releases/download/v1.4/darkice-1.4.tar.gz
<span class="token function">tar</span> -xvf darkice-1.4.tar.gz
<span class="token builtin class-name">cd</span> darkice-1.4

<span class="token comment"># Configuring darkice with ALSA and lame and building it</span>
./configure --with-alsa --with-lame
<span class="token function">make</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span></span>
</code></pre></div><p>I&#x27;ve used the default <strong>hackme</strong> password when I&#x27;ve installed <code>icecast2</code>.</p><p>The config for <code>icecast2</code> can be found at <code>/etc/icecast2/icecast.xml</code>.</p><p>The configuration for <code>darkice</code> saved in <code>~/darkice.cfg</code>:</p><div class="remark-highlight"><pre class="language-bash  line-numbers"><code class="language-bash"><span class="token comment"># this section describes general aspects of the live streaming session </span>
<span class="token punctuation">[</span>general<span class="token punctuation">]</span> 
duration     <span class="token operator">=</span> <span class="token number">0</span>     <span class="token comment"># duration of encoding, in seconds. 0 means forever </span>
bufferSecs   <span class="token operator">=</span> <span class="token number">5</span>     <span class="token comment"># size of internal slip buffer, in seconds </span>
reconnect    <span class="token operator">=</span> <span class="token function">yes</span>   <span class="token comment"># reconnect to the server(s) if disconnected </span>
<span class="token comment"># this section describes the audio input that will be streamed </span>
<span class="token punctuation">[</span>input<span class="token punctuation">]</span> 
device          <span class="token operator">=</span> plughw:1,0  <span class="token comment"># Soundcard device for the audio input </span>
sampleRate      <span class="token operator">=</span> <span class="token number">22050</span>     <span class="token comment"># sample rate in Hz. try 11025, 22050 or 44100 </span>
bitsPerSample   <span class="token operator">=</span> <span class="token number">16</span>        <span class="token comment"># bits per sample. try 16 </span>
channel         <span class="token operator">=</span> <span class="token number">1</span>         <span class="token comment"># channels. 1 = mono, 2 = stereo </span>
<span class="token comment"># this section describes a streaming connection to an IceCast2 server </span>
<span class="token comment"># there may be up to 8 of these sections, named [icecast2-0] ... [icecast2-7] </span>
<span class="token punctuation">[</span>icecast2-0<span class="token punctuation">]</span> 
bitrateMode     <span class="token operator">=</span> abr       <span class="token comment"># average bit rate </span>
<span class="token function">format</span>          <span class="token operator">=</span> mp3       <span class="token comment"># format of the stream: ogg vorbis </span>
bitrate         <span class="token operator">=</span> <span class="token number">86</span>        <span class="token comment"># bitrate of the stream sent to the server </span>
server          <span class="token operator">=</span> localhost <span class="token comment"># host name of the server </span>
port            <span class="token operator">=</span> <span class="token number">8000</span>      <span class="token comment"># port of the IceCast2 server, usually 8000 </span>
password        <span class="token operator">=</span> hackme 
mountPoint      <span class="token operator">=</span> Stream.mp3  <span class="token comment"># mount point of this stream on the IceCast2 server </span>
name            <span class="token operator">=</span> Raspberry Pi Stream <span class="token comment"># name of the stream </span>
description     <span class="token operator">=</span> Broadcast from Raspberry Pi <span class="token comment"># description of the stream </span>
<span class="token comment">#public          = yes       advertise this stream?</span><span aria-hidden="true" class="line-numbers-rows"><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span></span>
</code></pre></div><p>To found out the right device you can run arecord -l and will return all the
recording devices available. The card index is the first number, in my case 1
and the device index is the second number, in my case 0.</p><p>The password field is the source-password from the icecast2  config.</p><p>And now, for starting everything we need first to start icecast2 by starting
its service:</p><div class="remark-highlight"><pre class="language-bash  line-numbers"><code class="language-bash"><span class="token function">sudo</span> systemctl start icecast2<span aria-hidden="true" class="line-numbers-rows"><span class=""></span></span>
</code></pre></div><p>And then we run darkice with our config file:</p><div class="remark-highlight"><pre class="language-bash  line-numbers"><code class="language-bash"><span class="token function">sudo</span> darkice -c ~/darkice.cfg<span aria-hidden="true" class="line-numbers-rows"><span class=""></span></span>
</code></pre></div><p>You can also create a service for darkice replacing the username with your
account username (line 8 and 14):</p><div class="remark-highlight"><pre class="language-bash  line-numbers"><code class="language-bash"><span class="token comment"># /etc/systemd/system/darkice.service</span>
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Darkice <span class="token function">service</span>
After <span class="token operator">=</span> network-online.target sound.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">User</span><span class="token operator">=</span>ubuntu
<span class="token assign-left variable">ExecStartPre</span><span class="token operator">=</span>/bin/sleep <span class="token number">5</span>
<span class="token assign-left variable">StandardOutput</span><span class="token operator">=</span>syslog
<span class="token assign-left variable">StandardError</span><span class="token operator">=</span>syslog
<span class="token assign-left variable">SyslogIdentifier</span><span class="token operator">=</span>darkice
<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/bin/darkice -c /home/ubuntu/darkice.cfg
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-abort
<span class="token assign-left variable">CPUSchedulingPolicy</span><span class="token operator">=</span>fifo
<span class="token assign-left variable">CPUSchedulingPriority</span><span class="token operator">=</span><span class="token number">4</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span><span class=""></span></span>
</code></pre></div></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Creating a radio station on a Raspberry Pi using DarkIce and IceCast2","tags":["Linux","Raspberry Pi","Ubuntu","Audio"],"publishedOn":"2022-03-12T16:36:45.620Z","dirName":"post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2","content":{"compiledSource":"var N=Object.defineProperty,i=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var t=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var m=(e,n,s)=\u003en in e?N(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=\u003e{for(var s in n||(n={}))o.call(n,s)\u0026\u0026m(e,s,n[s]);if(t)for(var s of t(n))r.call(n,s)\u0026\u0026m(e,s,n[s]);return e},c=(e,n)=\u003ei(e,d(n));var l=(e,n)=\u003e{var s={};for(var p in e)o.call(e,p)\u0026\u0026n.indexOf(p)\u003c0\u0026\u0026(s[p]=e[p]);if(e!=null\u0026\u0026t)for(var p of t(e))n.indexOf(p)\u003c0\u0026\u0026r.call(e,p)\u0026\u0026(s[p]=e[p]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var p=s,{components:e}=p,n=l(p,[\"components\"]);return mdx(MDXLayout,c(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,`At my church we offer translations to people who cannot speak romanian, but the\nsystem we are using is pretty low quality and is a lot of static noise and is\ntoo expensive to upgrade it.`),mdx(\"p\",null,`So I've thinked I would be able to use a Raspberry Pi 3, an audio interface and\nsome software to create a radio station that would then be hooked to the actual\nsystem.`),mdx(\"p\",null,`After searching for some software that would work on Raspberry Pi 3 I\ndiscovered `,mdx(\"inlineCode\",{parentName:\"p\"},\"IceCast2\"),` that would be able to create a radio station and using\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"DarkIce\"),\" to send the live audio from the microphone to \",mdx(\"inlineCode\",{parentName:\"p\"},\"IceCast2\"),\".\"),mdx(\"p\",null,\"So I've booted \",mdx(\"inlineCode\",{parentName:\"p\"},\"Ubuntu 20.04\"),\" for Raspberry Pi and installed \",mdx(\"inlineCode\",{parentName:\"p\"},\"icecast2\"),` from the\npackage manager.\nFor the `,mdx(\"inlineCode\",{parentName:\"p\"},\"darkice\"),\" the version from the package manager was \",mdx(\"strong\",{parentName:\"p\"},\"1.13\"),`, but the\nlatest available is `,mdx(\"strong\",{parentName:\"p\"},\"1.14\"),` so I needed to compile it.  After some tries and\nsearching and found that needed to install `,mdx(\"inlineCode\",{parentName:\"p\"},\"ALSA\"),` and compile another library,\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"lame\"),\", because could not figure out how to configure \",mdx(\"inlineCode\",{parentName:\"p\"},\"darkice\"),` to use the\ndeveloper package from the package manager I figure it out and built the latest\nversion of `,mdx(\"inlineCode\",{parentName:\"p\"},\"darkice\"),\".\"),mdx(\"p\",null,\"After playing out with both the \",mdx(\"inlineCode\",{parentName:\"p\"},\"darkice\"),\" configuration and the \",mdx(\"inlineCode\",{parentName:\"p\"},\"icecast2\"),`\nconfiguration I had a working radio station.\nThe only problem that I couldn't anticipated was that the latency was just too\nhigh for what I needed. I had around `,mdx(\"strong\",{parentName:\"p\"},\"5 to 10 seconds\"),` of latency, which would\nbe quite perfect for a normal radio station, but not what I needed.`),mdx(\"p\",null,\"So here are the complet steps that I followed:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-bash  line-numbers\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Installing icecast2\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Installing ALSA utilities\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Installing pkgconfig required for `darkice` configuration\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Installing build-essentials for compiling `darkice` and `lame`\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"apt\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"install\"),` -y icecast2 alsa-utils asound2 libasound2-dev pkgconfig build-essentials\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Getting lame\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"wget\"),` https://sourceforge.net/projects/lame/files/lame/3.100/lame-3.100.tar.gz\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"tar\"),` -xvf lame-3.100.tar.gz\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin class-name\"}),\"cd\"),` lame-3.100\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Configuring lame and building it\"),`\n./configure --with-fileio`,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"lame --disable-gtktest --enable-expopt\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"full --prefix\",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`/usr\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"make\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"make\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"install\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Getting darkice\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"wget\"),` https://github.com/rafael2k/darkice/releases/download/v1.4/darkice-1.4.tar.gz\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"tar\"),` -xvf darkice-1.4.tar.gz\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin class-name\"}),\"cd\"),` darkice-1.4\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Configuring darkice with ALSA and lame and building it\"),`\n./configure --with-alsa --with-lame\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"make\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"make\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"install\"),mdx(\"span\",a({parentName:\"code\"},{\"aria-hidden\":\"true\",className:\"line-numbers-rows\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"}))),`\n`))),mdx(\"p\",null,\"I've used the default \",mdx(\"strong\",{parentName:\"p\"},\"hackme\"),\" password when I've installed \",mdx(\"inlineCode\",{parentName:\"p\"},\"icecast2\"),\".\"),mdx(\"p\",null,\"The config for \",mdx(\"inlineCode\",{parentName:\"p\"},\"icecast2\"),\" can be found at \",mdx(\"inlineCode\",{parentName:\"p\"},\"/etc/icecast2/icecast.xml\"),\".\"),mdx(\"p\",null,\"The configuration for \",mdx(\"inlineCode\",{parentName:\"p\"},\"darkice\"),\" saved in \",mdx(\"inlineCode\",{parentName:\"p\"},\"~/darkice.cfg\"),\":\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-bash  line-numbers\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# this section describes general aspects of the live streaming session \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"general\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),` \nduration     `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"0\"),\"     \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# duration of encoding, in seconds. 0 means forever \"),`\nbufferSecs   `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"5\"),\"     \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# size of internal slip buffer, in seconds \"),`\nreconnect    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"yes\"),\"   \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# reconnect to the server(s) if disconnected \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# this section describes the audio input that will be streamed \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"input\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),` \ndevice          `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" plughw:1,0  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# Soundcard device for the audio input \"),`\nsampleRate      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"22050\"),\"     \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# sample rate in Hz. try 11025, 22050 or 44100 \"),`\nbitsPerSample   `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"16\"),\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# bits per sample. try 16 \"),`\nchannel         `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"1\"),\"         \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# channels. 1 = mono, 2 = stereo \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# this section describes a streaming connection to an IceCast2 server \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# there may be up to 8 of these sections, named [icecast2-0] ... [icecast2-7] \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"icecast2-0\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),` \nbitrateMode     `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" abr       \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# average bit rate \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"format\"),\"          \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" mp3       \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# format of the stream: ogg vorbis \"),`\nbitrate         `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"86\"),\"        \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# bitrate of the stream sent to the server \"),`\nserver          `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" localhost \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# host name of the server \"),`\nport            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"8000\"),\"      \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# port of the IceCast2 server, usually 8000 \"),`\npassword        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` hackme \nmountPoint      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Stream.mp3  \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# mount point of this stream on the IceCast2 server \"),`\nname            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Raspberry Pi Stream \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# name of the stream \"),`\ndescription     `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Broadcast from Raspberry Pi \",mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# description of the stream \"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"#public          = yes       advertise this stream?\"),mdx(\"span\",a({parentName:\"code\"},{\"aria-hidden\":\"true\",className:\"line-numbers-rows\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"}))),`\n`))),mdx(\"p\",null,`To found out the right device you can run arecord -l and will return all the\nrecording devices available. The card index is the first number, in my case 1\nand the device index is the second number, in my case 0.`),mdx(\"p\",null,\"The password field is the source-password from the icecast2  config.\"),mdx(\"p\",null,`And now, for starting everything we need first to start icecast2 by starting\nits service:`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-bash  line-numbers\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" systemctl start icecast2\",mdx(\"span\",a({parentName:\"code\"},{\"aria-hidden\":\"true\",className:\"line-numbers-rows\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"\"}))),`\n`))),mdx(\"p\",null,\"And then we run darkice with our config file:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-bash  line-numbers\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" darkice -c ~/darkice.cfg\",mdx(\"span\",a({parentName:\"code\"},{\"aria-hidden\":\"true\",className:\"line-numbers-rows\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"\"}))),`\n`))),mdx(\"p\",null,`You can also create a service for darkice replacing the username with your\naccount username (line 8 and 14):`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-bash  line-numbers\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# /etc/systemd/system/darkice.service\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"Unit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"Description\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"Darkice \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"service\"),`\nAfter `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` network-online.target sound.target\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"Service\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"Type\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`simple\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"User\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`ubuntu\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"ExecStartPre\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"/bin/sleep \",mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"5\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"StandardOutput\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`syslog\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"StandardError\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`syslog\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"SyslogIdentifier\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`darkice\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"WorkingDirectory\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`/\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"ExecStart\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`/usr/local/bin/darkice -c /home/ubuntu/darkice.cfg\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"Restart\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`on-abort\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"CPUSchedulingPolicy\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`fifo\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"CPUSchedulingPriority\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token number\"}),\"4\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"Install\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token assign-left variable\"}),\"WantedBy\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"multi-user.target\",mdx(\"span\",a({parentName:\"code\"},{\"aria-hidden\":\"true\",className:\"line-numbers-rows\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"})),mdx(\"span\",a({parentName:\"span\"},{className:\"\"}))),`\n`))))}MDXContent.isMDXComponent=!0;\n","scope":{}},"skip":null},"__N_SSG":true},"page":"/posts/[dirName]","query":{"dirName":"post2_creating_a_radio_station_on_a_raspberry_pi_using_darkice_and_icecast2"},"buildId":"q6iS-DDoknARBkdbxoWaq","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>